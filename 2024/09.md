# 2024/09/01

### 今日の主なタスク

- 個人開発を行う Web アプリの要件定義をする

### 進捗メモ

- Google Docs に基本的な要件を書き出しておいた。
  - 本アプリは記憶定着に有効なコーネルメソッドでのノートテイキングが簡単にできるもので、コーネルメソッドについてもめちゃ少し調べた。

### 学び/課題

- 要件定義にあたり、Claude には「要件定義に必要な情報があったら自分に質問してください」と Claude からの質問を促し、それに答えることで簡単に要件定義が行えた。
  - 単に質問を答えるとそれっぽい要件定義ができる。

### 明日の TODO

- 開発環境を整えたい

明日以降でまだ UI やデータ構造など決めていないので決めたい。

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/02

### 今日の主なタスク

- 環境構築
-

### 進捗メモ

以下のような環境を構築した。

- FE
  - NextJS
- BE
  - Hono
- DB
  - Cloudflare D1

Cloudflare 周りを操作するための CLI（wrangler）をインストールし、その CLI で Cloudflare にログインした。

今回は画像のアップロードをスコープに入れていないので、Cloudflare R2（ストレージ）はセットアップしていない。

D1 のセットアップは完了して、wrangler.toml ファイルに設定内容を記載した。

### 学び/課題

- Wrangler.toml ファイルに D1 の設定をしていて、database_id などクレデンシャルのような値を設定するが、開発用であればまあベタガキでも良い

### 明日の TODO

- 要件定義の続きをやろう

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/03

### 今日の主なタスク

- 要件定義

### 進捗メモ

- claude に要件定義に必要な情報は何かを質問してもらい、答えてもらうことによって要件を詰めてった。

- UI、データモデル、非機能要件などを現時点で決まっているものを Docs に書いた。

#### 明日以降やる

- UI の詳細設計
- データベース設計
- 認証システムの実装方法と決定
- カテゴリーとタグ管理の詳細設計

### 学び/課題

- Claude がアプリケーション開発の手順や進め方を丁寧に教えてくれて良い

### 明日の TODO

- UI の詳細設計

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/04

### 今日の主なタスク

- UI の詳細設計
-

### 進捗メモ

Claude に手伝ってもらいながら UI の詳細を設計した。

以下を決めた

- ワイヤーフレームの作成
- 各画面の主要コンポーネントの定義
- ユーザーフローの定義
- 色彩設計とタイポグラフィの選択

ワイヤーフレームの作成は figma でするのは学習コストなどもかかりめんどくさいので v0 を使って生成する。
claude に v0 に食わせるプロンプトを英語で用意させてそのまま食わせてあげる

DB の設計と ER 図も書いておいた。

![ER図](/2024/image/note-nexus_DB_ER.png)

### 学び/課題

- サクッと UI の詳細設計をするなら Claude ✖️ v0 が楽で良さそう

### 明日の TODO

- 作成した DB 設計と ER 図を元に実際に D1 に作成済みの DB にテーブルを作って、サンプリデータを入れる

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/05

### 今日の主なタスク

- 作成した DB 設計と ER 図を元に実際に D1 に作成済みの DB にテーブルを作って、サンプリデータを入れる

### 進捗メモ

- ほぼ毎日しているリファクタリングの学習記録の記載と、読書でタスクがそんなできなかった。
- sql ファイルは明日のところでゴリゴリ書いていく予定

### 学び/課題

「ステートメントの関数内の移動」というリファクタリング手法についての内容だった。

これは、ある関数の外側にある、その関数に関連する処理をその関数内に移動させるもので、コードの重複や、関数の一貫性と再利用性を向上させるもの。

### 明日の TODO

- 明日こそ spl ファイル作る。sql ほとんど書いたことないので書き方学びながら書いていこうかな

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/06

### 今日の主なタスク

- sql ファイルを作る

### 進捗メモ

以下のテーブルの sql を作成した

- users
- categories
- tags
- notes
- note_categories
  - note と categories を紐付け
- note_tags
  　　- note と tags を紐付け
- sample_data

### 学び/課題

スキーマの定義はまだ学習が必要そう

### 明日の TODO

- 実際に D1 にデーブルを作って、入っている値を見る

### コードメモ（必要時）

```

```

---

# 2024/09/０７

コミュニティナーシングの参加で疲れてめっちゃ眠いのでタスクとしては少なめでやる

### 今日の主なタスク

- 実際に D1 にテーブル作って、入っている値を見る

### 進捗メモ

- sql ファイルを実行して D1（local）にテーブルを作成
- テーブルにサンプルデータを入れているので、それを wrangler コマンドで確認してみる。

### 学び/課題

- NEMUI

### 明日の TODO

- FE に取り掛かりたい。

BE と FE どちらからやるのが良いのかはよくわからんけど、FE は FE 側で仮に作ったサンプルデータ使って作って、最後に API とか作る方針でいこうかな。

### コードメモ（必要時）

```
sqlファイルの実行
npx wrangler d1 execute note-nexus-db --local --file=./src/schemas/note_categories.sql

DBの操作をする
npx wrangler d1 execute note-nexus-db --local --command="SELECT * FROM USERS;"
```

---

# 2024/09/08

### 今日の主なタスク

- FE に取り掛かる

### 進捗メモ

FE の開発を始めた。

FE と API どちらを先にするか迷ったが、最初に FE 側を作って、どのような値が欲しいのかの解像度を高めてから API 作成に着手するのがなんとなく良い気がしたので FE からやる

### 学び/課題

上記のアプローチには以下のような利点があるらしい（claude 回答）

```
ユーザー中心の設計:
フロントエンド（FE）の実装を先に行うことで、ユーザーの視点からどのようなデータが必要かを具体的に把握できます。これはユーザー体験（UX）を向上させる上で非常に重要です。

効率的なバックエンド設計:
FEの要求を明確に理解した上でAPIとデータベースを設計することで、不必要な機能の実装を避け、本当に必要な機能に集中できます。

イテレーティブな開発:
FEとBEを並行して開発することで、早い段階で問題点を発見し、修正することができます。これはアジャイル開発の原則とも合致します。

オーバーエンジニアリングの回避:
実際のFEの要求に基づいてAPIを設計することで、過剰な機能や複雑さを避けることができます。

コミュニケーションの促進:
FEとBEの開発者間でより密接なコミュニケーションが必要となり、チーム全体の理解が深まります。

プロトタイピングの容易さ:
FEのモックアップやプロトタイプを早期に作成することで、ステークホルダーとのコミュニケーションが容易になります。
```

### 明日の TODO

- FE の開発に時間かけないように v0 で画面を作っているので、FE の基盤部分を作成しようかと思う。

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/09

### 今日の主なタスク

- FE の基盤部分を整える（抽象的すぎ）

### 進捗メモ

v0 で作成された画面の global な css や layout などを参考に全体的なスタイルを当てる

### 学び/課題

以下のようなエラー吐かれてた

```
 ⨯ Error: Event handlers cannot be passed to Client Component props.
  <button className=... onClick={function onClick} children=...>
```

NextJS は server、client どちらでもいけるので、client コンポーネントの場合はファイル上部に明示的に指定する必要あった（忘れてた）

```ts
"use client";
```

### 明日の TODO

- 基盤部分まだできてないのでやっていき

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/１０

### 今日の主なタスク

- FE の基盤部分をやった

### 進捗メモ

アプリ全体の Layout.tsx を整えた。

ヘッダー、フッターなどの全画面に共通する部分と Metadata（アプリのタイトルや説明など）を書いた

### 学び/課題

- tailwindCSS の属性をあんま知らないので、よく使うやつについては覚えた方が良さそう。

### 明日の TODO

- 画面遷移だけさせようかな

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/11

### 今日の主なタスク

- 別のことしてて時間取れないので画面遷移だけする

### 進捗メモ

画面遷移するようにした

### 学び/課題

### 明日の TODO

- API はまだ着手できていないので、モックデータ作って FE の開発を進める

### コードメモ（必要時）

NextJS での画面遷移（雑めも）

```ts
import { useRouter } from "next/navigation";

const router = useRouter();

// 使用例
router.push("/create");
```

---

# 2024/09/12

### 今日の主なタスク

- FE 開発用のモックデータを作る
- モックデータを元に FE の開発を進める

### 進捗メモ

- モックデータの作成
  - データ作りはめんどくさいので、テーブル構造を claude に食わせて、生成してもらった。
- 集中できんすぎて本読みました mm

### 学び/課題

-

### 明日の TODO

- notes の状態をどこで持つべきかちょい考える

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/13

### 今日の主なタスク

- FE の実装

### 進捗メモ

- サンプルデータいじってた

### 学び/課題

- FE の実装をやっているけど、やっていくうちにどんなデータが欲しいのかはなんとなくわかってくるが、ゴリゴリに設計をしているわけではないのでコロコロ欲しいデータの形が変わり定まらない。

### 明日の TODO

- 明日、明後日（土曜日、日曜日）は一日予定が入っているのでほとんどできん！

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/14

### 今日の主なタスク

- 特になし

### 進捗メモ

- 夜に明日返す予定の本「アジャイルサムライ」を読んでた。（読みきれなさそう）

### 学び/課題

-

### 明日の TODO

- 明日も 1 日予定があるので休憩！

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/15

### 今日の主なタスク

- 休憩

### 進捗メモ

FE を実装やってたけど、そろそろ BE の方もやらんといけん。

設計を疎かにしていたのが効いたのか、実装していくうちに「データ構造どうすればいい？」「認証とかよくわからんけど、どうするんだ」「FE、BE でどの機能を担わせるのが良い？」とかよくわからんくなってきた。

### 学び/課題

ある程度設計はちゃんとする必要ある（手を動かしたくなり設計疎かになってた）

### 明日の TODO

- FE でアイコンとか日付のフォーマットとかできていないのでそこらへんやるか

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/16

### 今日の主なタスク

- アイコンの整理
- 日付フォーマッター作る

### 進捗メモ

- 上記二つはやった。
- API の設計を始めた。
  - API のエンドポイントを表で整理
  - リソース定義

### 学び/課題

#### JWT

ステートレス（サーバーでセッション情報を保持する必要がない）で、高い拡張性、クロスドメインという特徴がある。

##### 使い方

1. ユーザーがログインすると、サーバーが JWT を生成して返す。
2. クライアントは以降のリクエストで、このトークンを Authorization ヘッダーに含める
3. サーバーは各リクエストでトークンを検証、有効な場合はリクエスト処理をする

#### OAuth2.0

サードパーティアプリケーションに対して、ユーザーのリソースへの制限付きアクセスを提供するための認可フレームワーク

複数の認可フロー、アクセストークンを使用してリソースにアクセス、アクセス権限を細かく制御可能である。

### 明日の TODO

- ユーザー管理機能の実装を始める

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/１７

### 今日の主なタスク

- ユーザー管理機能
  - 基本的な CRUD 操作の実装

### 進捗メモ

- エントリーポイントである index.ts の実装
- Hono アプリケーションの設定を行う app.ts を実装

### 学び/課題

Hono 結構ヘルパー、ミドルウェアが豊富

今回使うのは以下

- cors
- jwt
- logger
- prettyJSON

ミドルウェアは以下のような感じで使用する

`app.use([path,]middleware)`

```ts
import { logger } from "hono/logger";

const app = new Hono<{ Bindings: Env }>();

app.use("*", logger());
```

### 明日の TODO

- API 実装の続き

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/18

### 今日の主なタスク

- user 周りの API の実装

### 進捗メモ

model の実装をした。

- create
- findById
- findByUsername
- update
- delete

などの基本的なものを実装した。

### 学び/課題

- ORM を使用していないので、今後実装したい

### 明日の TODO

- controller の実装

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/19

### 今日の主なタスク

- controller の実装
- routing の実装

### 進捗メモ

基本的な CRUD 操作を実装。

routing ファイル内で`zod-validator`という`データの形状や構造を静的にチェックすることが可能なライブラリ`を使用してバリデーションを実装して、それぞれのコントローラーへのルーティングを設定した。

### 学び/課題

Hono で zod-Validation が用意されているのでそれを使用。

```ts
import { zValidator } from "@hono/zod-validator";

// userRoutes,userSchemaは定義済み

userRoutes.post("/", zValidator("json", userSchema), createUser);
```

zValidator の第 1 引数には検証対象（json,cookie,params など）を指定。
第 2 引数にはスキーマ、第 3 引数はオプショナルだけど、細かくエラーハンドリングをしたい場合は指定する。

### 明日の TODO

- password を hash にするための関数作る

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/20

### 今日の主なタスク

- password を hash にする関数を作る

### 進捗メモ

hash にするためのライブラリを入れた。

### 学び/課題

パスワードをそのままプレーンテキストとして DB に保存するのはセキュリティの観点でよくないのでハッシュ化させる。

### 明日の TODO

- 型定義ちゃんとやる

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/２１

### 今日の主なタスク

兄夫婦の家に行く予定で開発はしない

### 進捗メモ

[努力革命](https://www.amazon.co.jp/%E5%8A%AA%E5%8A%9B%E9%9D%A9%E5%91%BD-%E3%83%A9%E3%82%AF%E3%82%92%E3%81%99%E3%82%8B%E3%81%8B%E3%82%89%E6%88%90%E6%9E%9C%E3%81%8C%E5%87%BA%E3%82%8B%EF%BC%81-%E3%82%A2%E3%83%95%E3%82%BF%E3%83%BCGPT%E3%81%AE%E6%88%90%E9%95%B7%E8%A1%93-%E5%B9%BB%E5%86%AC%E8%88%8E%E5%8D%98%E8%A1%8C%E6%9C%AC-%E5%B0%BE%E5%8E%9F%E5%92%8C%E5%95%93-ebook/dp/B0D3LKM7H5/ref=sr_1_1?adgrpid=159199544805&dib=eyJ2IjoiMSJ9.xuRs2D6JduT4qHQmrAPh2a7UgO4c_y5xTDnSrNhZzTHRjD4A0Bp18tc4zUZlsN_x1Abr8NEwxxSbXsfOLfPIHFtgCcvgfnjswicydGv4E6NwOldTbs8kfSaQAylhrU26fWdTDOdO1LZhTrEUzNIDbZVWvQjLqbTNO4SJopSWHGP16MqCedIArnI0XR_FwiytgtfaW2M8kxbi_8QRlGuTdSZYtSjIuXGHqDeCbyCj2S4UXkehO8cxfxMuzgHStuvqxNYaTbZh8Be71SEQ87LjnkOZDHQNkLev61VDV1A0M6E.rQNMJeGZl6vZ6rs2mqbMu7TBPWi7LzQEVXKbdq8cuLs&dib_tag=se&gad_source=1&hvadid=696128567483&hvdev=c&hvlocphy=1009613&hvnetw=g&hvqmt=e&hvrand=5961388273250434391&hvtargid=kwd-2304293040661&hydadcr=16034_13711636&jp-ad-ap=0&keywords=%E5%8A%AA%E5%8A%9B%E9%9D%A9%E5%91%BD&qid=1727004549&sr=8-1)っていう書籍を読んでみたけどなかなか面白い。

ChatGPT のような大規模言語モデルが登場して努力のやり方は今までとはガラッと変わるので、うまく LLM を使って立ち回りたい。

### 学び/課題

-

### 明日の TODO

-

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/22

### 今日の主なタスク

- 予定あるので特になし

### 進捗メモ

-

### 学び/課題

-

### 明日の TODO

- ユーザー認証周りの実装を進めたい

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/23

### 今日の主なタスク

- ユーザー認証まわり

### 進捗メモ

router で zValidator を用いたバリデーションをして、controller に後続の処理をさせるようにしたかったが、なぜか controller 側でバリデーションされた後のパラメータを取得する際に`never`型となるので諦めて、router 側で controller ですべき処理を書くようにした。

### 学び/課題

- router と controller で役割を分けたい。

### 明日の TODO

- ユーザー認証まわりの続き

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/24

### 今日の主なタスク

- ユーザー認証まわり

### 進捗メモ

- ユーザー認証まわりのベースはできてそう。

### 学び/課題

-

### 明日の TODO

- zwt の シークレットの設定などをする

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/24

### 今日の主なタスク

- 動作確認しとく

### 進捗メモ

OpenSSL を使用して、zwt シークレットを生成した。

brew で openssl をインストール
`brew install openssl`

openssl の CLI でランダムな文字列を生成
`openssl rand -base64 32`

nodeJS の crypto でも同様なことはできるが、今回は OpenSSL を使用した。

### 学び/課題

-

### 明日の TODO

-

### コードメモ（必要時）

```
// コード
```

---

# 2024/09/25

postman で API を叩こうかと思ったけど、なんかうまくいかないので curl で叩くようにした

```
curl -X POST http://localhost:8787/api/users \
     -H "Content-Type: application/json" \
     -d '{"username":"testuser","password":"password123"}'
```

`-X POST`　 HTTP メソッドを POST に指定

`-H` HTTP ヘッダーを指定

`-d` POST データを指定

---

# 2024/09/26

今日は読書してた。

「[イシューからはじめよ](https://www.amazon.co.jp/%E3%82%A4%E3%82%B7%E3%83%A5%E3%83%BC%E3%81%8B%E3%82%89%E3%81%AF%E3%81%98%E3%82%81%E3%82%88%EF%BC%BB%E6%94%B9%E8%A8%82%E7%89%88%EF%BC%BD%E2%80%95%E2%80%95%E7%9F%A5%E7%9A%84%E7%94%9F%E7%94%A3%E3%81%AE%E3%80%8C%E3%82%B7%E3%83%B3%E3%83%97%E3%83%AB%E3%81%AA%E6%9C%AC%E8%B3%AA%E3%80%8D-%E5%AE%89%E5%AE%85%E5%92%8C%E4%BA%BA/dp/4862763561/ref=sr_1_1?adgrpid=51691974365&dib=eyJ2IjoiMSJ9.XhZiNVfOt1SrAcQzPiTjOHDLDahb6is55mxpU2T_VU2LZb4WeKDutlu0p1RojDXWZsjf9eDvYm2A6Uo7yC6QnryypEBKNlr08wpoYX4V-_hJhAcWSRT3umVOYKDeXo3l7pym3rWFOqM6FdoR2-gPu9wJsABSn4aGqBG1HarIF3a17aipul80hzyEnIeDKmTT0uaFMZCpE9pfFvuXY5a0jIsby5mJYRW_4VSdxmgKEGRcd1P0I0qxzOru7xIzV5vQ9Lo3g9ZMYvK0ku5fxeywVVJ80Sx9QDs7CrXBe1OYCrg.lDj7fy-J9w19z-bB5yACs-xUVB7vZqAa1Lui_Jb0LAE&dib_tag=se&hvadid=679083521642&hvdev=c&hvlocphy=1009613&hvnetw=g&hvqmt=e&hvrand=4411405871993422985&hvtargid=kwd-333310288002&hydadcr=2752_13722226&jp-ad-ap=0&keywords=%E3%82%A4%E3%82%B7%E3%83%A5%E3%83%BC%E3%81%8B%E3%82%89%E3%81%AF%E3%81%98%E3%82%81%E3%82%88&qid=1727353781&sr=8-1)」という超名著を結構前に買って読んでなかったので読み始めた。（オーディブルでは聞いてたが）

生産性が高い人の考え方が学べる書籍で、闇雲にあらゆる手段をとって時間を無駄に使うのではなく、「今ケリをつけるべき問題」を見定めて、そこに時間を使うのが良いよね的な本。

イシューを見定めるのがむずそう

---

# 2024/09/27

ユーザー関連の API を作成したので、動作テストをしてた。

Cloudflare Workers D1（ローカル）にレコードを保存しているので、保存されたレコードを以下のような手順で確認した。

```
（npxを使っている）

// D1データベースのリストを表示
npx wrangler d1 list

// 特定のDBの詳細を表示
npx wrangler d1 info <DB名>

// SQLクエリを直接実行
npx wrangler d1 execute <DB名> --local --command "SELECT * FROM users"
```

あとは本読んでた。
**仮説思考 -BCG 流　問題発見・解決の発送法**って本

kindle unlimited の無料体験期間に読み切りたい

---

# 2024/09/28

JWT の認証用のルートを作成。

authRoutes.ts を追加し、`/login`へ`username`と`password`を body として POST リクエストをするとログインできるようにした。

そこでは、DB に保存されているユーザー情報を比較、JWT トークンの生成をして、成功したら token と user 情報を返す。

### ゆる

今日は亀嵩温泉に入った。VIVANT の撮影地になった地元奥出雲にある亀嵩温泉は、前行ったときとは内装が変わっており少し困惑した。
VIVANT のオブジェには名高る俳優のサインが書かれてて興奮した。

久々にサウナに入ったがやっぱり最高。

---

# 2024/09/29

セキュリティを向上させる目的で、user 認証のパスワードをハッシュ化するようにした。

### Bcrypt（ビー・クリプト）

パスワードのハッシュ化手法の一つ。

Bcrypt は

- ソルトであること（ハッシュ化に使用する文字列がランダム）
- ストレッチング回数を任意の回数を指定できる

の理由から安全性が高い

### ログイン処理の流れ

- user_id, password を入力し、ユーザー登録をする
  - この際 password は hash にするアルゴリズムを通して hash 化される
- user_id, password を入力し、ログインをする
  - 登録時に hash 化した時のアルゴリズムを用いて入力した password を hash 化させる
- 登録時の hash とログイン時の hash を比べて認証をする

### ゆる

図書館で書籍を一冊借りた。

[とにかく仕組み化 ── 人の上に立ち続けるための思考法](https://www.amazon.co.jp/%E3%81%A8%E3%81%AB%E3%81%8B%E3%81%8F%E4%BB%95%E7%B5%84%E3%81%BF%E5%8C%96-%E2%94%80%E2%94%80-%E4%BA%BA%E3%81%AE%E4%B8%8A%E3%81%AB%E7%AB%8B%E3%81%A1%E7%B6%9A%E3%81%91%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E6%80%9D%E8%80%83%E6%B3%95-%E5%AE%89%E8%97%A4%E5%BA%83%E5%A4%A7/dp/4478117748)

まだまだ IT に触れて 1 年と 4 ヶ月、実務経験も 1 年の弱弱だが、なぜかマネジメント系の書籍が読みたくなる。
早く人の上に立って、組織をいい方向に持っていきたい。

---

# 2024/09/30

user 情報の更新する model の関数があるが、更新日時のカラム(updated_at)が無かったため転けていた。

wrangler の CLI を使って sql を叩いて、updated_at カラムを追加した。

```
// 現在のテーブル構造の確認
PRAGMA table_info(users);

// updated_at カラムの追加
ALTER TABLE users ADD COLUMN updated_at DATETIME;

// 既存のレコードの updated_at を現在の時刻で更新
UPDATE users SET updated_at = CURRENT_TIMESTAMP WHERE updated_at IS NULL;
```

---
